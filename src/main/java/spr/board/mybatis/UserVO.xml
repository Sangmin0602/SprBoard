<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spr.board.mybatis.IUserDao">

	<resultMap type="UserVO" id="fullUserMap">
		<constructor>
			<idArg column="seq" javaType="Integer"/>
			<arg column="userid" javaType="string" />
			<arg column="nickname" javaType="string"/>
			<arg column="email" javaType="string"/>
			<arg column="password" javaType="string"/>
			<arg column="when_joined" javaType="string"/>
		</constructor>
	</resultMap>
	
	<resultMap type="UserVO" id="userSetterMap">
		<result column="seq" property="seq"/>
		<result column="userid"  property="userId"/>
		<result column="nickname" property="nickName"/>
		<result column="email" property="email"/>
		<result column="password" property="password"/>
		<result column="when_joined" property="whenJoined"/>
	</resultMap>
	
	<select id="findAll" resultMap="fullUserMap">
		SELECT
			seq, 
			userid, 
			nickname, 
			email, 
			password, 
			when_joined
		FROM users
	</select>
	
	<select id ="userBySeq" parameterType="Integer" resultMap="fullUserMap">
		SELECT
			SEQ,
			USERID,
			NICKNAME,
			EMAIL,
			PASSWORD,
			WHEN_JOINED
		FROM USERS WHERE SEQ = #{SEQ}
	</select>
	
	<select id="loginCheck" parameterType="hashmap" resultMap="fullUserMap">
		SELECT 
			seq, 
			userid, 
			nickname, 
			email, 
			password, 
			when_joined 
		FROM users WHERE userId =  #{id} and password = #{pass}
	</select>
	
	<insert id="newUser" parameterType="UserVO" useGeneratedKeys="true" keyColumn="seq" keyProperty="seq">
		INSERT INTO users (userid, nickname, email, `password`) 
		VALUES (#{userId}, #{nickName}, #{email}, #{password})
	</insert>

</mapper>